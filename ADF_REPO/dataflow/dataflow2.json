{
	"name": "dataflow2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "IDMS_Blob_Storage",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "IDMS_o365",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "AlterRow1"
				}
			],
			"script": "source(output(\n\t\tUserName as string,\n\t\tDisplayName as string,\n\t\tEmployeeId as string,\n\t\tIsExecutiveEmployee as string,\n\t\tEmailId as string,\n\t\tTelephoneNumber as string,\n\t\tHomephoneNumber as string,\n\t\tPostalCode as string,\n\t\tPostalAddress as string,\n\t\tTerminationDate as date,\n\t\tIsActive as string,\n\t\tEmployeeType as string,\n\t\tCostCenter as string,\n\t\tCompanyName as string,\n\t\tDepartmentName as string,\n\t\tDivisionName as string,\n\t\tSectionName as string,\n\t\tPositionName as string,\n\t\tEmployeeSubArea as string,\n\t\tEESubGroupName as string,\n\t\tBranchName as string,\n\t\tUnitName as string,\n\t\t{WP.Full Name} as string,\n\t\t{WP.Email} as string,\n\t\tWorkLocationDescription as string,\n\t\t{Manager.DisplayName} as string,\n\t\t{Manager.EmailId} as string,\n\t\t{Supervisor.DisplayName} as string,\n\t\t{Supervisor.EmailId} as string,\n\t\t{EEGroup Description} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> source1\nsource1 alterRow(upsertIf(UserName!=' '),\n\tinsertIf(UserName!=' ')) ~> AlterRow1\nAlterRow1 sink(input(\n\t\tUserName as string,\n\t\tDisplayName as string,\n\t\tEmployeeId as string,\n\t\tIsExecEmp as string,\n\t\tEmailId as string,\n\t\tTelNumber as string,\n\t\tHomePhNumber as string,\n\t\tPostalCode as string,\n\t\tPostalAddress as string,\n\t\tTerminationDate as date,\n\t\tIsActive as string,\n\t\tEmployeeType as string,\n\t\tCostCenter as string,\n\t\tCompanyName as string,\n\t\tDeptName as string,\n\t\tDivName as string,\n\t\tSectName as string,\n\t\tPostionName as string,\n\t\tEESubArea as string,\n\t\tEESubGrpName as string,\n\t\tBranchName as string,\n\t\tUnitName as string,\n\t\tWPFullName as string,\n\t\tWPEmail as string,\n\t\tWrkLocDesc as string,\n\t\tMgrDispName as string,\n\t\tMgrEmailId as string,\n\t\tSupDispName as string,\n\t\tSupEmailId as string,\n\t\tEEGroupDesc as string,\n\t\tBU as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:true,\n\tkeys:['UserName'],\n\tformat: 'table',\n\tmapColumn(\n\t\tUserName,\n\t\tDisplayName,\n\t\tEmployeeId,\n\t\tIsExecEmp = IsExecutiveEmployee,\n\t\tEmailId,\n\t\tTelNumber = TelephoneNumber,\n\t\tHomePhNumber = HomephoneNumber,\n\t\tPostalCode,\n\t\tPostalAddress,\n\t\tTerminationDate,\n\t\tIsActive,\n\t\tEmployeeType,\n\t\tCostCenter,\n\t\tCompanyName,\n\t\tDeptName = DepartmentName,\n\t\tDivName = DivisionName,\n\t\tSectName = SectionName,\n\t\tPostionName = PositionName,\n\t\tEESubArea = EmployeeSubArea,\n\t\tEESubGrpName = EESubGroupName,\n\t\tBranchName,\n\t\tUnitName,\n\t\tWPFullName = {WP.Full Name},\n\t\tWPEmail = {WP.Email},\n\t\tWrkLocDesc = WorkLocationDescription,\n\t\tMgrDispName = {Manager.DisplayName},\n\t\tMgrEmailId = {Manager.EmailId},\n\t\tSupDispName = {Supervisor.DisplayName},\n\t\tSupEmailId = {Supervisor.EmailId},\n\t\tEEGroupDesc = {EEGroup Description}\n\t),\n\tdateFormat:'yyyy-MM-dd',\n\ttimestampFormat:'yyyy.MM.dd HH:mm:ss',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}